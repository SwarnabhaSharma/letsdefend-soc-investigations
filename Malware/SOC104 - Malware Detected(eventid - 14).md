# SOC Alert Investigation

## 1. Alert Overview
- **Platform:** LetsDefend SOC Environment
- **Alert Name / ID:** SOC104 - Malware Detected
- **Event ID:** 14
- **Category:** Malware
- **Severity:** High
- **Date & Time:** Sep, 15, 2020, 09:02 PM
- **MITRE ATT&CK (if applicable):**
  - [T1036 – Masquerading](https://attack.mitre.org/techniques/T1036/) *(potential concern — malware often masquerades as `googleupdate.exe`)*
  - [T1547 – Boot or Logon Autostart Execution](https://attack.mitre.org/techniques/T1547/) *(Google Update runs at startup; worth verifying no abuse)*

**Description:**  
The endpoint security solution on host `JohnComputer` (IP: `172.16.17.82`) flagged a file named `googleupdate.exe` (MD5: `0bca3f16dd527b4150648ec1e36cb22a`) as potentially malicious. The device action was **Allowed** — the file was not quarantined. The alert was raised to the SOC for analyst triage to determine whether this represents a genuine threat or a false positive.

---

## 2. Initial Analysis

- **Attacker IP:** N/A (No external attacker IP identified)
- **Host IP:** 172.16.17.82
- **Hostname / User:** JohnComputer
- **Relevant Logs / Indicators:**
  - **File Name:** `googleupdate.exe`
  - **MD5 Hash:** `0bca3f16dd527b4150648ec1e36cb22a`
  - **SHA256 Hash:** `b60e92004d394d0b14a8953a2ba29951c79f2f8a6c94f495e3153dfbbef115b6`
  - **File Size:** 152.45 KB
  - **Device Action:** Allowed (not quarantined)
  - **Expected Legitimate Path:** `C:\Program Files (x86)\Google\Update\GoogleUpdate.exe`
  - **File Sample (Password: `infected`):** [Download from LetsDefend](https://download.cyberlearn.academy/download/download?url=https://files-ld.s3.us-east-2.amazonaws.com/GoogleUpdate.bin.zip)

---

## 3. Investigation Steps

- **Step 1 – Alert Triage:**  
  Reviewed alert metadata: triggered on `JohnComputer` (`172.16.17.82`) at 21:02 on Sep 15, 2020. The flagged file is `googleupdate.exe`. Device action was **Allowed**, meaning the EDR/AV did not automatically block or quarantine the file. Severity is High — requires analyst investigation.

- **Step 2 – File Hash Analysis (VirusTotal):**  
  Submitted the SHA256 hash `b60e92004d394d0b14a8953a2ba29951c79f2f8a6c94f495e3153dfbbef115b6` to VirusTotal. Result: **0/72 engines** flagged the file as malicious. The file is recognized as a legitimate `GoogleUpdate.exe` binary signed by **Google LLC**. [VT Report](https://www.virustotal.com/gui/file/b60e92004d394d0b14a8953a2ba29951c79f2f8a6c94f495e3153dfbbef115b6)

- **Step 3 – File Hash Analysis (IBM X-Force):**  
  Searched the MD5 hash `0bca3f16dd527b4150648ec1e36cb22a` on IBM X-Force Threat Intelligence. Result: **Clean / No malicious activity** associated with this hash. Corroborates the VirusTotal finding.

- **Step 4 – Endpoint Security / Process Path Check:**  
  Examined the process details on the endpoint security console. The `googleupdate.exe` binary was located at the expected legitimate path:  
  `C:\Program Files (x86)\Google\Update\GoogleUpdate.exe`  
  File path is consistent with the official Google Chrome automatic update service. No anomalous parent-child process relationships observed.

- **Step 5 – Log Management Review:**  
  Searched Log Management using the host IP `172.16.17.82` for suspicious network traffic or anomalous activity around 21:02 on Sep 15, 2020. **No suspicious logs found.** Network connections initiated by `googleupdate.exe` were outbound to Google's CDN/update servers — consistent with legitimate update behavior.

- **Step 6 – Browser History Review:**  
  Reviewed browser history on `JohnComputer`. Found evidence of the user visiting **Google Chrome update/support pages** prior to the alert, indicating the user manually initiated or was aware of the Chrome update process. This corroborates legitimate update activity.

- **Step 7 – Verdict Determination:**  
  Based on all evidence — clean VirusTotal/X-Force scan, legitimate file path, no suspicious logs, and corroborating browser history — this alert is assessed as a **False Positive**. The file is a legitimate Google Chrome update binary (`GoogleUpdate.exe`) performing its expected update function.

---

## 4. Findings & Evidence

- **VirusTotal (SHA256):** 0/72 detections — Clean  
  [https://www.virustotal.com/gui/file/b60e92004d394d0b14a8953a2ba29951c79f2f8a6c94f495e3153dfbbef115b6](https://www.virustotal.com/gui/file/b60e92004d394d0b14a8953a2ba29951c79f2f8a6c94f495e3153dfbbef115b6)
- **IBM X-Force (MD5):** No malicious activity — Clean
- **File Path:** `C:\Program Files (x86)\Google\Update\GoogleUpdate.exe` — legitimate location
- **Digital Signature:** Signed by **Google LLC** — valid and trusted
- **Log Management:** No suspicious network traffic or anomalous behavior detected on `172.16.17.82` around the alert time
- **Browser History:** User visited Chrome update/support pages prior to alert — confirms user-initiated update activity
- **Device Action:** `Allowed` — the endpoint security agent did not quarantine the file, further implying low confidence in the detection

---

## 5. Incident Classification
- **Final Verdict:** False Positive
- **Attack Stage:** N/A
- **Attack Vector:** N/A
- **Malware Type:** N/A (File is legitimate)
- **Impact:** None — No malicious activity occurred. The Google Chrome update process executed as expected.

---

## 6. Response & Mitigation

- **Immediate Containment:**  
  No containment required. File is legitimate and device action was already `Allowed`. No evidence of compromise.

- **Indicator Blocking:**  
  No blocking required. The file hash corresponds to a clean, signed Google binary. Adding it to a blocklist would be erroneous and disruptive.

- **Credential Reset:**  
  Not required. No evidence of credential theft or unauthorized access.

- **Malware Removal & Host Remediation:**  
  Not required. `googleupdate.exe` is a legitimate Google Update service binary — removal would break Chrome's update mechanism.

- **Threat Hunt:**  
  No broad threat hunt initiated. Alert was isolated to a single host with a benign root cause. If similar alerts recur across multiple hosts, consider initiating a hunt for:
  - `googleupdate.exe` running from non-standard paths
  - Unsigned or differently-hashed versions of `googleupdate.exe`

- **IOC Sharing:**  
  No IOCs to share externally. Alert determined to be a false positive; sharing would introduce noise.

- **Recommended Follow-up:**  
  1. **Whitelist** the file hash `b60e92004d394d0b14a8953a2ba29951c79f2f8a6c94f495e3153dfbbef115b6` in the endpoint security tool to prevent recurrence.
  2. Verify directly with the user `JohnComputer` that they initiated or authorized a Chrome update.
  3. Tune the detection rule to reduce false positives for signed Google binaries running from expected paths.

---

## 7. Lessons Learned

- Legitimate software update processes (such as `googleupdate.exe`) can trigger AV/EDR alerts due to their behavior: running in the background, auto-starting at logon, and initiating outbound network connections. These behaviors **mirror** some common malware behaviors, leading to false positives.
- Multi-source validation is essential: VirusTotal alone may not always be sufficient, but when combined with IBM X-Force results, file path verification, digital signature validation, and contextual log review, a confident verdict can be reached.
- **Masquerading (T1036)** is a real and common technique — adversaries do place malicious binaries named `googleupdate.exe` in non-standard paths. Always verify the **file path** in addition to the hash to rule out path-based masquerading.
- Proper tuning of detection rules (e.g., whitelisting signed binaries from expected paths) reduces alert fatigue and improves SOC efficiency.

---

## Indicators of Compromise (IOCs)

| Type | Value |
|---|---|
| Sender Email | N/A |
| Sender Domain | N/A |
| SMTP Relay IP | N/A |
| C2 IP | N/A |
| C2 Port | N/A |
| Attachment Name | N/A |
| Malware Name | N/A (False Positive — Legitimate `GoogleUpdate.exe`) |
| MD5 Hash | `0bca3f16dd527b4150648ec1e36cb22a` |
| SHA256 Hash | `b60e92004d394d0b14a8953a2ba29951c79f2f8a6c94f495e3153dfbbef115b6` |
| Malware Family | N/A |
| Mutex | N/A |
| Persistence Path | N/A |
| Victim Host IP | 172.16.17.82 |
| Victim User | JohnComputer |

---

## Notes
- Environment: Simulated SOC / Lab Environment
- This investigation was conducted for learning and skill development purposes.
- Alert closed as: **False Positive** — No malicious activity confirmed.
