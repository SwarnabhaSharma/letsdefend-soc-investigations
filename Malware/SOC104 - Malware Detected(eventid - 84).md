# SOC Alert Investigation

## 1. Alert Overview
- **Platform:** LetsDefend SOC Environment
- **Alert Name / ID:** SOC104 - Malware Detected
- **Event ID:** 84
- **Category:** Malware
- **Severity:** Medium
- **Date & Time:** Mar, 21, 2021, 01:04 PM
- **MITRE ATT&CK (if applicable):**
  - [T1105 – Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105/)
  - [T1036.005 – Masquerading: Match Legitimate Name or Location](https://attack.mitre.org/techniques/T1036/005/)

**Description:**  
An alert was triggered when a user on `SusieHost` (`172.16.17.5`) downloaded `winrar600.exe` from `win-rar.com`. The endpoint security system flagged the file as potentially malicious malware. The download was allowed by the security policy, requiring a manual investigation to determine if the file is a genuine WinRAR installer or a malicious masqueraded binary.

---

## 2. Initial Analysis

- **Attacker IP:** 51.195.68.163 (`win-rar.com`)
- **Host IP:** 172.16.17.5
- **Hostname / User:** SusieHost
- **Relevant Logs / Indicators:**
  - **File Name:** `winrar600.exe`
  - **MD5 Hash:** `c74862e16bcc2b0e02cadb7ab14e3cd6`
  - **SHA256 Hash:** `aff4bb9b15bccff67a112a7857d28d3f2f436e2e42f11be14930fe496269d573`
  - **File Size:** 2.95 MB
  - **Device Action:** Allowed (not quarantined)
  - **Requested URL:** `https://www.win-rar.com/postdownload.html?&L=0&Version=32bit`

---

## 3. Investigation Steps

- **Step 1 – Alert Triage:** 
  The alert states that `winrar600.exe` was downloaded on `SusieHost`. Initial details show the source as the official WinRAR website. The action was "Allowed," meaning the file is present on the system.

- **Step 2 – Static Analysis (Threat Intelligence):**
  - **VirusTotal:** The hash `aff4bb9b15bccff67a112a7857d28d3f2f436e2e42f11be14930fe496269d573` was searched. Results show **0/72** detections, marking the file as clean and recognized as a legitimate WinRAR installer.
  - **Digital Signature:** The file is digitally signed by **RARLAB / Alexander Roshal**, confirming its authenticity.

- **Step 3 – Dynamic Analysis (Sandbox):**
  - **Any.Run:** Analysis of the file in Any.Run shows "Malicious Activity" tags. However, closer inspection indicates these are triggered by common installer behaviors: dropping an uninstaller (`uninstall.exe`), modifying registry keys for file associations, and creating directories in `Program Files`. No actual C2 communication or malicious payload execution was observed.
  - **Hybrid Analysis:** Corroborates that the file performs typical installation tasks.

- **Step 4 – Log & Network Review:**
  The source IP `51.195.68.163` belongs to `win-rar.com` (OVH Germany). This is a highly reputable domain. The traffic occurred over HTTPS (Port 443), consistent with a legitimate software download.

- **Step 5 – Endpoint Status:**
  Attempts to access `SusieHost` for direct terminal analysis or browser history review were unsuccessful as the host appeared to be offline/down during the investigation. However, based on the file and network evidence, a conclusive verdict can still be reached.

---

## 4. Findings & Evidence

- **VirusTotal:** [Clean Report (0 Detections)](https://www.virustotal.com/gui/file/aff4bb9b15bccff67a112a7857d28d3f2f436e2e42f11be14930fe496269d573/detection)
- **Any.Run:** [Sandbox Report](https://app.any.run/tasks/330e49ef-860c-491d-bb1f-8c53cf01aa18) - Verified as a legitimate installer behavior.
- **URL Reputation:** `win-rar.com` is the official distributor of WinRAR.
- **Signed Binary:** The file has a valid digital signature from `Alexander Roshal`.

---

## 5. Incident Classification
- **Final Verdict:** False Positive
- **Attack Stage:** N/A
- **Attack Vector:** Web Download
- **Malware Type:** None (Legitimate Software)
- **Impact:** None

---

## 6. Response & Mitigation

- **Immediate Containment:**
  No containment required as the activity is benign.

- **Indicator Blocking:**
  None required. Do **not** block the IP or hash as they are legitimate.

- **Credential Reset:** 
  Not required.

- **Malware Removal & Host Remediation:** 
  Not required. However, it is recommended to update WinRAR to the latest version (6.2x+) to avoid historical vulnerabilities (like CVE-2023-38831) present in older versions like 6.0.0.

- **Threat Hunt:** 
  Not required.

- **IOC Sharing:** 
  None.

---

## 7. Lessons Learned

- Security solutions may flag legitimate software installers as "Malicious" because they perform actions similar to malware, such as writing to system directories, dropping executable files (uninstallers), and modifying registry keys for persistence or file associations.
- Always verify digital signatures of installers to ensure they haven't been tampered with or replaced by masqueraded binaries.
- Even if a host is offline, external threat intelligence (VirusTotal, Hybrid Analysis) and source reputation can provide enough data to reach a confident "False Positive" verdict.

---

## Indicators of Compromise (IOCs)

| Type | Value |
|---|---|
| Sender Email | N/A |
| Sender Domain | win-rar.com |
| SMTP Relay IP | N/A |
| C2 IP | N/A |
| C2 Port | N/A |
| Attachment Name | winrar600.exe |
| Malware Name | N/A (Legitimate Software) |
| SHA256 Hash | `aff4bb9b15bccff67a112a7857d28d3f2f436e2e42f11be14930fe496269d573` |
| Malware Family | N/A |
| Mutex | N/A |
| Persistence Path | N/A |
| Victim Host IP | 172.16.17.5 |
| Victim User | SusieHost |

---

## Notes
- Environment: Simulated SOC / Lab Environment
- This investigation was conducted for learning and skill development purposes.
