# SOC Alert Investigation

## 1. Alert Overview
- **Platform:** LetsDefend SOC Environment
- **Alert Name / ID:** SOC119 - Proxy - Malicious Executable File Detected
- **Event ID:** 83
- **Category:** Malware
- **Severity:** Medium
- **Date & Time:** Mar, 21, 2021, 01:02 PM
- **MITRE ATT&CK (if applicable):**
  - N/A — Alert confirmed as a False Positive. No malicious technique applies.
  - *(Considered during triage: [T1204.002 – User Execution: Malicious File](https://attack.mitre.org/techniques/T1204/002/) and [T1105 – Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105/) — both ruled out upon investigation)*

**Description:**  
The proxy security solution flagged an outbound HTTP request from host `SusieHost` (IP: `172.16.17.5`, User: `Susie`) to `win-rar.com` (IP: `51.195.68.163`) as a potential "Malicious Executable File Detected" event. The request URL was `https://www.win-rar.com/postdownload.html?&L=0&Version=32bit`, accessed via `Chrome` on Windows. Device action was **Allowed**. Upon investigation, `win-rar.com` is the **official** WinRAR download website — a legitimate, widely trusted file archiving utility developed by RARLAB (win.rar GmbH). The alert was generated by a generic proxy rule that flags any `.exe` file download regardless of source legitimacy. This alert is a **False Positive**.

---

## 2. Initial Analysis

- **Attacker IP:** 51.195.68.163 *(flagged by proxy — confirmed legitimate on investigation)*
- **Attacker Hostname:** win-rar.com *(official WinRAR download site — not an attacker)*
- **Host IP:** 172.16.17.5
- **Hostname / User:** SusieHost
- **Username:** Susie
- **Relevant Logs / Indicators:**
  - **Request URL:** `https://www.win-rar.com/postdownload.html?&L=0&Version=32bit`
  - **User Agent:** Chrome - Windows
  - **Device Action:** Allowed
  - **Process:** `chrome.exe`
  - **Parent Process:** `explorer.exe`
  - **Parent Process MD5:** `8b88ebbb05a0e56b7dcc708498c02b3e`
  - **Download Type:** Browser-initiated (GET request from Chrome, initiated by user action)

---

## 3. Investigation Steps

- **Step 1 – Alert Triage:** 
  Reviewed alert metadata: triggered on `SusieHost` (`172.16.17.5`) at 1:02 PM on Mar 21, 2021. The proxy flagged a connection to `win-rar.com` (`51.195.68.163`) via Chrome, classified as a potential malicious executable download. Device action was **Allowed**. Severity is **Medium**. The URL pattern (`postdownload.html`) and the variable `Version=32bit` strongly suggests a user-initiated download of WinRAR software. Initial concern: is this a legitimate software download or a spoofed/typosquatted site?

- **Step 2 – Domain & URL Reputation Check (VirusTotal):**  
  Queried the full request URL `https://www.win-rar.com/postdownload.html?&L=0&Version=32bit` on VirusTotal.  
  Result: **0 malicious detections** — the URL is clean and categorized as a software download page from the official WinRAR vendor site.  
  [VT URL Report](https://www.virustotal.com/gui/url/bc62b755250c21cf885d35ec4eac37a7fb5faf373f9786074dc33ad997286841)

- **Step 3 – Domain Legitimacy Verification:**  
  Verified that `win-rar.com` is the **official website** of WinRAR, the widely used file archiving utility developed by Eugene Roshal of **win.rar GmbH (RARLAB)**. The domain has been active since WinRAR's early history and is consistently referenced as the primary legitimate download source. The domain is not a typosquat, lookalike, or malicious impersonation. `rarlab.com` is the secondary official domain. Both are legitimate.

- **Step 4 – Destination IP Reputation Check:**  
  Queried the destination IP `51.195.68.163` on VirusTotal and Talos Intelligence.  
  Result: **Clean** — No malicious activity or threat reputation associated with this IP. IP is consistent with hosting a legitimate software vendor website.

- **Step 5 – Process & Parent Process Analysis:**  
  The request originated from `chrome.exe` with parent process `explorer.exe` (MD5: `8b88ebbb05a0e56b7dcc708498c02b3e`). This process chain is entirely consistent with a user manually opening a browser and navigating to a website — a completely normal, expected user behavior. There are no anomalous process relationships (e.g., malware spawning a browser, or a script initiating a hidden download).

- **Step 6 – Log Management Review:**  
  Reviewed log management for `SusieHost` (`172.16.17.5`) in the period surrounding the Mar 21, 2021, 1:02 PM alert. **No suspicious outbound connections** to known malicious IPs or C2 servers were observed. Network activity from `SusieHost` was limited to the WinRAR website request and normal browser traffic. No signs of lateral movement, data exfiltration, or post-download malicious behavior were detected.

- **Step 7 – Endpoint Activity Review:**  
  Reviewed endpoint telemetry for `SusieHost`. No suspicious child processes spawned after the download, no registry modifications consistent with malware persistence, no file encryption or deletion events, and no unusual service installations. The downloaded WinRAR executable appears not to have been executed in a harmful manner, or it was simply installed normally as a utility. Endpoint activity is consistent with a legitimate software installation.

- **Step 8 – Verdict Determination:**  
  All evidence consistently points to a legitimate user action: user `Susie` on `SusieHost` used Chrome to download WinRAR from its official download page. The proxy alert was triggered by a generic rule that flags any executable (`.exe`) file download, regardless of source legitimacy. No malicious indicators were identified at any layer (URL, IP, process chain, endpoint, logs). This alert is a **False Positive**.

---

## 4. Findings & Evidence

- **VirusTotal URL Scan:** 0/90+ detections — Clean. `win-rar.com` is the official WinRAR download site.  
  [https://www.virustotal.com/gui/url/bc62b755250c21cf885d35ec4eac37a7fb5faf373f9786074dc33ad997286841](https://www.virustotal.com/gui/url/bc62b755250c21cf885d35ec4eac37a7fb5faf373f9786074dc33ad997286841)
- **Destination IP `51.195.68.163`:** Clean — No malicious reputation on VirusTotal or Talos Intelligence
- **Domain Verification:** `win-rar.com` is the confirmed official website of WinRAR by win.rar GmbH (RARLAB) — a globally recognized legitimate software vendor with 500M+ users
- **Process Chain:** `explorer.exe` → `chrome.exe` — entirely normal, user-initiated browser download pattern; no anomalous process relationships
- **Log Management:** No suspicious outbound traffic, C2 beaconing, or data exfiltration from `SusieHost` (`172.16.17.5`) at or after the alert time
- **Endpoint Telemetry:** No malicious post-download behavior observed — no persistence mechanisms, no unusual process spawning, no file system anomalies
- **Rule Trigger Cause:** The proxy rule `SOC119 - Proxy - Malicious Executable File Detected` is a generic rule that fires on any `.exe` file download — it does not distinguish between legitimate software vendors and malicious sources, causing this false positive

---

## 5. Incident Classification
- **Final Verdict:** False Positive
- **Attack Stage:** N/A — No attack occurred
- **Attack Vector:** N/A — User performed a legitimate software download from an official vendor website
- **Malware Type:** N/A — File is legitimate (WinRAR installer from win-rar.com)
- **Impact:** None — No malicious activity observed. User `Susie` downloaded WinRAR (a widely trusted archiving utility) from its official website using Chrome.

---

## 6. Response & Mitigation

- **Immediate Containment:**
  No containment required. The download originated from a verified legitimate source (`win-rar.com`), the process chain shows normal browser behavior, and log analysis reveals no post-download malicious activity. Isolating or blocking `SusieHost` would be erroneous and disruptive to a legitimate user.

- **Indicator Blocking:**
  No blocking required. Adding `win-rar.com` or `51.195.68.163` to a blocklist would prevent users from downloading a widely used, legitimate archiving utility and would introduce operational disruption. Do **not** add this to any blocklist.

- **Credential Reset:** 
  Not required. No evidence of credential compromise, malicious activity, or unauthorized access on `SusieHost`.

- **Malware Removal & Host Remediation:** 
  Not required. WinRAR downloaded from `win-rar.com` is a legitimate utility. No malware was introduced to `SusieHost`. If organizational policy restricts unauthorized software installation, coordinate with IT/change management to ensure WinRAR is approved — but this is a policy concern, not a security incident.

- **Threat Hunt:** 
  No broad threat hunt initiated for this alert. Incident is isolated and benign. However, recommend reviewing:
  - Whether the user `Susie` was authorized to install software (if a software restriction policy exists)
  - Whether similar proxy alerts are firing across other users for legitimate software downloads — if so, this indicates a rule tuning opportunity

- **IOC Sharing:** 
  No IOCs to share externally. This is a confirmed false positive — sharing `win-rar.com` or its IP as a threat indicator would introduce noise and false intelligence into threat sharing platforms.

- **Recommended Follow-up:**  
  1. **Whitelist** `win-rar.com` and `51.195.68.163` in the proxy detection rule to prevent recurrence for future legitimate WinRAR downloads.
  2. **Tune the proxy rule** `SOC119 - Proxy - Malicious Executable File Detected` to incorporate domain/IP reputation scoring before alerting — purely signature-based `.exe` download rules generate excessive false positives against legitimate vendors.
  3. **Verify with user `Susie`** that she intentionally downloaded WinRAR and that the download was for a legitimate business or personal use purpose. If software installation policy requires IT approval, this should be noted.
  4. Consider building an **approved software allowlist** for the proxy to suppress known-good download sources (e.g., `win-rar.com`, `nirsoft.net`, `7-zip.org`, etc.)

---

## 7. Lessons Learned

- **Generic proxy rules produce excessive false positives.** A rule that fires on any `.exe` file download — without evaluating the reputation of the source domain, IP, or the actual file hash — will generate significant alert noise. SOC teams should tune proxy rules to incorporate at minimum a domain reputation layer (e.g., Talos, VirusTotal score threshold) before escalating to analyst review.
- **Context is decisive in proxy alert triage.** The combination of: (a) an official, widely-known vendor domain (`win-rar.com`), (b) a browser-initiated user download process chain (`explorer.exe` → `chrome.exe`), and (c) zero post-download suspicious endpoint activity — collectively and quickly resolves this as a false positive. A structured triage approach prevents unnecessary analyst time spent on benign events.
- **Legitimate software downloads are common false positive triggers.** Utilities such as WinRAR, 7-Zip, Notepad++, and similar tools are frequently downloaded by users and will trigger generic executable-download proxy rules. Maintaining an enterprise-approved software whitelist in the security stack (proxy, EDR, SIEM) significantly reduces false positive volume.
- **Proxy alerts supplement, not replace, endpoint telemetry.** The key corroborating evidence here was the endpoint telemetry showing no post-download malicious behavior. Proxy alerts should always be correlated with EDR/SIEM data before a verdict is issued.
- **False positives still require documentation.** Even though this is a false positive, documenting the full investigation chain ensures the analysis can be referenced if a similar alert arises in the future, and supports rule tuning decisions with evidence.

---

## Indicators of Compromise (IOCs)

| Type | Value |
|---|---|
| Sender Email | N/A |
| Sender Domain | N/A |
| SMTP Relay IP | N/A |
| C2 IP | N/A (False Positive — `51.195.68.163` is the legitimate win-rar.com server) |
| C2 Port | N/A |
| Attachment Name | N/A |
| Malware Name | N/A (False Positive — WinRAR installer from official site) |
| SHA256 Hash | N/A (File hash not captured in proxy alert) |
| Malware Family | N/A |
| Mutex | N/A |
| Persistence Path | N/A |
| Victim Host IP | N/A (False Positive — no victim) |
| Victim User | N/A (False Positive — `Susie` on `SusieHost` performed a legitimate download) |

---

## Notes
- Environment: Simulated SOC / Lab Environment
- This investigation was conducted for learning and skill development purposes.
